<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Code Execution Explainer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <header>
        <div>
            <h1>AI Code Execution Explainer</h1>
            <div class="subtitle">Sandboxed execution tracing with LLM-powered explanations</div>
        </div>
        <div style="font-size: 0.75rem; color: var(--text-muted);">Gemini 2.0 Flash</div>
    </header>

    <div class="container">
        <div class="examples-bar">
            <span style="font-size: 0.75rem; color: var(--text-muted); line-height: 2;">Examples:</span>
            <button onclick="loadExample('fibonacci')">Fibonacci</button>
            <button onclick="loadExample('bubblesort')">Bubble Sort</button>
            <button onclick="loadExample('factorial')">Factorial</button>
            <button onclick="loadExample('binary_search')">Binary Search</button>
        </div>

        <div class="input-section">
            <div class="code-input-wrapper">
                <label for="code-input">Python Code</label>
                <textarea id="code-input" spellcheck="false" placeholder="# Enter Python code here...&#10;&#10;x = 10&#10;for i in range(3):&#10;    x += i&#10;print(x)">x = 10
for i in range(3):
    x += i
print(x)</textarea>
            </div>
            <div class="controls">
                <label for="depth">Explanation Depth</label>
                <select id="depth">
                    <option value="beginner">Beginner</option>
                    <option value="intermediate" selected>Intermediate</option>
                    <option value="advanced">Advanced</option>
                </select>
                <div class="btn-row">
                    <button onclick="runTrace()" id="btn-trace">Trace Only</button>
                    <button onclick="runExplain()" id="btn-explain">Trace + Explain</button>
                </div>
            </div>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <span id="loading-text">Executing code...</span>
        </div>

        <div class="results" id="results" style="display: none;">
            <div class="panel">
                <div class="panel-header">
                    <span>Execution Trace</span>
                    <span id="trace-status"></span>
                </div>
                <div class="panel-body" id="trace-panel"></div>
            </div>

            <div class="panel">
                <div class="panel-header">
                    <span>AI Explanation</span>
                    <span id="explanation-depth"></span>
                </div>
                <div class="panel-body" id="explanation-panel">
                    <div style="color: var(--text-muted); font-size: 0.85rem;">
                        Click "Trace + Explain" to generate AI-powered explanations.
                    </div>
                </div>
            </div>
        </div>

        <div id="debug-section" class="hidden">
            <details>
                <summary>Raw Trace JSON</summary>
                <div class="panel" style="margin-top: 0.5rem;">
                    <div class="panel-body">
                        <pre id="raw-json" style="font-family: var(--mono); font-size: 0.75rem; white-space: pre-wrap; color: var(--text-muted);"></pre>
                    </div>
                </div>
            </details>
            <details>
                <summary>LLM Prompt Preview</summary>
                <div class="panel" style="margin-top: 0.5rem;">
                    <div class="panel-body">
                        <pre id="prompt-preview" class="prompt-preview"></pre>
                    </div>
                </div>
            </details>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
